Description: Don't try to use sysinfo on non-Linux

Fixes FTBFS on kfreebsd due to use of a Linux-specific system call:
https://buildd.debian.org/status/fetch.php?pkg=beignet&arch=kfreebsd-amd64&ver=1.0.1-3&stamp=1425101150

Origin: https://github.com/freebsd/freebsd-ports-graphics/blob/opencl/lang/beignet/files/patch-src_cl__device__id.c
Author: Koop Mast, Rebecca Palmer

--- a/src/cl_device_id.c
+++ b/src/cl_device_id.c
@@ -33,7 +33,12 @@
 #include <stdio.h>
 #include <string.h>
 #include <stdlib.h>
+#if defined(linux) || defined(__linux__) || defined(__LINUX__)
 #include <sys/sysinfo.h>
+#else
+#include <sys/types.h>
+#include <sys/sysctl.h>
+#endif
 
 #ifndef CL_VERSION_1_2
 #define CL_DEVICE_BUILT_IN_KERNELS 0x103F
@@ -424,6 +429,7 @@ skl_gt4_break:
   cl_driver_delete(dummy);
 #endif
 
+#if defined(linux) || defined(__linux__) || defined(__LINUX__)
   struct sysinfo info;
   if (sysinfo(&info) == 0) {
     uint64_t two_gb = 2 * 1024 * 1024 * 1024ul; 
@@ -432,6 +438,22 @@ skl_gt4_break:
                             two_gb : info.totalram;
     ret->max_mem_alloc_size = ret->global_mem_size / 2;
   }
+#else
+  int mib[2];
+
+  mib[0] = CTL_HW;
+  mib[1] = HW_USERMEM;
+
+  uint64_t totalram;
+  size_t len;
+  len = sizeof(totalram);
+  sysctl(mib, 2, &totalram, &len, NULL, 0);
+
+  uint64_t two_gb = 2 * 1024 * 1024 * 1024ul;
+  ret->global_mem_size = (totalram > two_gb) ?
+                            two_gb : totalram;
+  ret->max_mem_alloc_size = ret->global_mem_size / 2;
+#endif
 
   return ret;
 }

